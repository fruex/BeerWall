#@beerwall_apitest_HostAddress = http://localhost:5254/api
#@beerwall_apitest_HostAddress = https://beerwall-apitest-cjcfgfehh9grhne5.polandcentral-01.azurewebsites.net/api
@beerwall_apitest_HostAddress = http://api-debug.igibeer.pl:7000
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1laWRlbnRpZmllciI6IjExMTExMTExLTExMTEtMTExMS0xMTExLTExMTExMTExMTExMSIsImp0aSI6Ijk2NDgwMGJkLTJkNWQtNDFmZC05ZWQxLTMwNDQxODY1YWY5ZiIsInJvbGVzIjoiTW9iaWxlIiwiZmlyc3ROYW1lIjoiTW9iaWxlIiwibGFzdE5hbWUiOiJVc2VyIiwiZXhwIjoxNzY5MzMwMzYxLCJpc3MiOiJJZ2lCZWVyIiwiYXVkIjoiTW9iaWxlIn0.CEfUAcwvpKuBWRW_hBkeGtz9E7scWZP9c4H5dCGmXPY

### 1. SignIn - Login i automatycznie zapisz token
# @name signin
POST {{beerwall_apitest_HostAddress}}/mobile/auth/signIn
Accept: application/json
Content-Type: application/json

{
  "email": "mobile",
  "password": "mobile"
}

> {%
    client.log("Raw body: " + JSON.stringify(response.body));

    client.global.set("net_token", response.body.data.tokenDto.token);
    client.global.set("refresh_token", response.body.data.tokenDto.refreshToken);
    client.log("✓ Token zapisany, wygasa za: " + response.body.data.tokenDto.tokenExpires + "s");
    client.log("  Token: " + response.body.data.tokenDto.token.substring(0, 50) + "...");
%}

### 2. RefreshToken - Odśwież wygasły token
# @name refreshToken
GET {{beerwall_apitest_HostAddress}}/mobile/auth/refreshToken
Accept: application/json
Authorization: Bearer {{token}}
Content-Type: application/json

> {%
    client.global.set("net_token", response.body.data.token);
    client.global.set("refresh_token", response.body.data.refreshToken);
    client.log("✓ Token odświeżony, nowy wygasa za: " + response.body.data.tokenExpires + "s");
%}

### 3. GoogleSignIn - Logowanie przez Google
# @name googleSignIn
POST {{beerwall_apitest_HostAddress}}/mobile/auth/googleSignIn
Accept: application/json
Content-Type: application/json

{
  "idToken": "GOOGLE_ID_TOKEN_HERE"
}

> {%
    client.global.set("net_token", response.body.data.token);
    client.global.set("refresh_token", response.body.data.refreshToken);
    client.log("✓ Token z Google zapisany");
%}

### 4. GetCards - Pobierz karty (używa zapisanego tokenu)
GET {{beerwall_apitest_HostAddress}}/mobile/cards
Accept: application/json
Authorization: Bearer {{token}}

### 5. ToggleCardStatus - Aktywuj/Dezaktywuj kartę
POST {{beerwall_apitest_HostAddress}}/mobile/cards/activation
Accept: application/json
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "cardId": "36373864-6136-3661-2d31-6135302d3465",
  "activate": true
}

### 5. AssignCard
PUT {{beerwall_apitest_HostAddress}}/mobile/cards/assign
Accept: application/json
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "cardId": "36373864-6136-3661-2d31-6135302d3465",
  "description": "Karta NFC"
}

### 6. GetHistory - Pobierz historię transakcji
GET {{beerwall_apitest_HostAddress}}/mobile/users/history
Accept: application/json
Authorization: Bearer {{token}}

### 7. GetPaymentOperators - Pobierz operatorów płatności
GET {{beerwall_apitest_HostAddress}}/mobile/payments/operators
Accept: application/json
Authorization: Bearer {{token}}

### 8. GetBalance - Pobierz saldo
GET {{beerwall_apitest_HostAddress}}/mobile/users/balance
Accept: application/json
Authorization: Bearer {{token}}

### 9. TopUp - Doładuj konto
POST {{beerwall_apitest_HostAddress}}/mobile/payments/topUp
Accept: application/json
Content-Type: application/json
Authorization: Bearer {{net_token}}

{
  "premisesId": 5,
  "paymentMethodId": 2007,
  "amount": 50.00
}

### GoogleSignIn
POST {{beerwall_apitest_HostAddress}}/mobile/auth/googleSignIn
Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IjRiYTZlZmVmNWUxNzIxNDk5NzFhMmQzYWJiNWYzMzJlMGY3ODcxNjUiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIyMjA1MjI5MzI2OTQtM3I3YjQ3cTIydGZuYzBibWszNHM5YjloYXB2YjdxdW8uYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiIyMjA1MjI5MzI2OTQtZ2hhbWdvcXBxdG1iMHZrOWFqbm91aXFlMmg1MmF0ZWIuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMDc0Nzk3NTQ4MDY2MDQzOTMzNDQiLCJlbWFpbCI6ImFkcmlhbi5ib3RvckBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFkcmlhbiBCb3RvciIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NKbkhDR0JIanpvVndBaVlJMnBaaU1zNlFQV2JUTmpNVFF4RXRHYVBnOGd0bkZRVUE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQWRyaWFuIiwiZmFtaWx5X25hbWUiOiJCb3RvciIsImlhdCI6MTc2ODI5NDU3OCwiZXhwIjoxNzY4Mjk4MTc4fQ.HeEEzyDny3Jzc63XyDw6wknkGA8skaL6Pygpvv2WcnEI_pwCrLfxYFB2TlOn8S6lbpUksPNedzacovLE0A5UhUOKSG-hv9Ec-McGp-Dn-3sdhyozHBby8kdUjDTab9msZnXHsTTLp7xEZnbXNRTkcIE7av0cU8lrL4A7n1tYxKOiek2Z0R6zyjmHridE1WckosTarq5zS7nLWBMeG9vgivBSWC1UVAb-B-WtMb-Pc1kuqjAfU1QHOMaRqniDSVp2YZ3lTAYJpYUm_6wNvaaIXdTGasA_LDXjz_cUYsk2Yg8n2yvz4bQThruizvREz-ZrZEqRSGIF0fIy6Zo1s9QEmw
